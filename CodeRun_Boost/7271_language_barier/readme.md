# 7271. –Ø–∑—ã–∫–æ–≤–æ–π –±–∞—Ä—å–µ—Ä

üü¢ –†–µ—à–µ–Ω–∞ ‚ö™ –°–ª–æ–∂–Ω–∞—è

–û—Ä–∫–µ—Å—Ç—Ä —Å—ã–≥—Ä–∞–ª –∏–¥–µ–∞–ª—å–Ω–æ: –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞ –ë—Ä–µ–π—Å —Å–∏—è–µ—Ç –æ—Ç –≤–æ—Å—Ç–æ—Ä–≥–∞, –∞ –ö–æ–¥–µ—Ä—É–Ω —É—Ä—á–∏—Ç –æ—Ç —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è.

–ì–æ—Å—Ç–∏ –≤—ã—Ö–æ–¥—è—Ç –≤ –¥–≤–æ—Ä—Ü–æ–≤—ã–π —Å–∞–¥ –ø–æ–¥—ã—à–∞—Ç—å —Å–≤–µ–∂–∏–º –≤–æ–∑–¥—É—Ö–æ–º... –ù–æ —á—Ç–æ —ç—Ç–æ? –ñ–∏—Ç–µ–ª–∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –æ–±–∏—Ç–∞—Ç–µ–ª–∏ –∂—ë—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞ –≤–¥—Ä—É–≥ –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –ø–æ–Ω–∏–º–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞! –ü–æ—Ö–æ–∂–µ, –∫—Ç–æ-—Ç–æ —É–º—ã—à–ª–µ–Ω–Ω–æ –≤–º–µ—à–∞–ª—Å—è –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏: —Ç–µ–ø–µ—Ä—å –æ–¥–Ω–∏ –≥–æ—Å—Ç–∏ –≥–æ–≤–æ—Ä—è—Ç –Ω–∞ –ø—Ä–∏–≤—ã—á–Ω–æ–º —è–∑—ã–∫–µ, –∞ –¥—Ä—É–≥–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–ª–æ–≤. –í–æ–∑–Ω–∏–∫–∞—é—Ç —Å—Å–æ—Ä—ã, –∫–æ–º–∞–Ω–¥—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –¥–∞–∂–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –¥–µ—Å–µ—Ä—Ç–æ–≤ –∑–∞—Å—Ç—Ä—è–ª–æ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è.

–ö —Å—á–∞—Å—Ç—å—é, —É –Ω–∞—Å –µ—Å—Ç—å —Å–ø–∏—Å–∫–∏ ‚Äî –∏ –ø–æ–ª–Ω—ã—Ö, –∏ —É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤. –ù–æ –≤—Å—ë –ø–µ—Ä–µ–º–µ—à–∞–Ω–æ.

–ú–æ–∂–µ—Ç –±—ã—Ç—å, —Ç—ã —Å–º–æ–∂–µ—à—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏ –∏ –≤–µ—Ä–Ω—É—Ç—å –ø–æ—Ä—è–¥–æ–∫ –Ω–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–µ?

## –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞

–ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ $n$ ($1 \le n \le 2 \cdot 10^5$), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä —Å–ª–æ–≤.
–í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –º–∞—Å—Å–∏–≤ –∏–∑ $2 \cdot n$ —Å—Ç—Ä–æ–∫ $w_i$ ($1 \le |w_i| \le 10^5$), –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–µ –ø–æ–ª–Ω—ã–µ –∏ —É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞.

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ:
* —Å—É–º–º–∞—Ä–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–ª–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ $\sum |w_i| \le 5 \cdot 10^6$.
* –≤—Å–µ —Å–ª–æ–≤–∞ —Å–æ—Å—Ç–æ—è—Ç —Ç–æ–ª—å–∫–æ –∏–∑ –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

–†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –º–∞—Å—Å–∏–≤ –∏–∑ $n$ –ø–∞—Ä —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª $(s_i, f_i)$ ($1 \le s_i, f_i \le 2 \cdot n$), –æ–±–æ–∑–Ω–∞—á–∞—é—â–∏—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏:
* $s_i$ ‚Äî –∏–Ω–¥–µ–∫—Å **–≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** —É–∫–æ—Ä–æ—á–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª–Ω–æ–º—É —Å–ª–æ–≤—É $f_i$.
* $f_i$ ‚Äî –∏–Ω–¥–µ–∫—Å **–≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –ø–æ–ª–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –ø–∞—Ä—ã $i$.

–§–æ—Ä–º–∞–ª—å–Ω–æ, —Å–ª–æ–≤–æ —Å –∏–Ω–¥–µ–∫—Å–æ–º $s_i$ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º —Å–ª–æ–≤–∞ $f_i$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–ª–∏–Ω—ã.

–í—Å–µ –∏–Ω–¥–µ–∫—Å—ã –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, —Ç–æ –µ—Å—Ç—å –¥–ª—è –ª—é–±–æ–π –ø–∞—Ä—ã $i \neq j$:
* $f_i \neq f_j$;
* $s_i \neq s_j$.

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –æ—Ç–≤–µ—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –≤—ã–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ | 2 —Å
---|---
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ | 256 –ú–ë

## –ü—Ä–∏–º–µ—Ä 1

### –í–≤–æ–¥
```

2
abac
abacab
aba
abaa

```

### –í—ã–≤–æ–¥
```

3 4
1 2

```