# 7508. –î—Ä–µ–≤–Ω–∏–µ —Ç–æ–Ω–Ω–µ–ª–∏

üü¢ –†–µ—à–µ–Ω–∞ ‚ö™ –°—Ä–µ–¥–Ω—è—è

–£—Ä–∞, –ö–æ–¥–µ—Ä—É–Ω –≤–µ—Ä–Ω—É–ª—Å—è!

–¢—ã –µ–≥–æ –Ω–∞—à—ë–ª! –ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ! –¢–µ–ø–µ—Ä—å –≤—Å—ë –Ω–∞–ª–∞–¥–∏—Ç—Å—è!

‚Äî –Ø —É–ø—É—Å—Ç–∏–ª –∑–ª–æ–¥–µ—è. –ù–æ —è —É–∑–Ω–∞–ª, –∫—Ç–æ —ç—Ç–æ. –≠—Ç–æ CTRodent ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ —Å–∏—Å—Ç–µ–º—ã. –û–Ω —Ö–æ—á–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 32-–±–∏—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –ê –¥–ª—è —ç—Ç–æ–≥–æ –æ–Ω —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–Ω–µ—Å—Ç–∏ –≤–µ—Å—å —ç—Ç–æ—Ç –º–∏—Ä!

–ö–æ–¥–µ—Ä—É–Ω —Å–º–æ–≥ –≤—ã—è—Å–Ω–∏—Ç—å –∫–æ–≤–∞—Ä–Ω—ã–π –ø–ª–∞–Ω CTRodent'–∞. –ù–µ–≥–æ–¥—è–π —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ–±—Ä–∞—Ç—å—Å—è –≤–æ –¥–≤–æ—Ä–µ—Ü –ø–æ –¥—Ä–µ–≤–Ω–∏–º, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –µ—â—ë –≤ —ç–ø–æ—Ö—É dial-up'–∞, –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –ø–æ–¥–∑–µ–º–Ω—ã–º —Ç–æ–Ω–Ω–µ–ª—è–º.

–ü–æ–¥–∑–µ–º–µ–ª—å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è $n$ ($1 \le n \le 2 \cdot 10^5$) —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–æ–Ω–Ω–µ–ª—è–º–∏. –ö–æ–º–Ω–∞—Ç—ã –º–æ–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∑–∞–¥–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–æ–º $a$ —Ä–∞–∑–º–µ—Ä–∞ $n$. –ò–∑ –∫–æ–º–Ω–∞—Ç—ã —Å –Ω–æ–º–µ—Ä–æ–º $i$ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤ –∫–æ–º–Ω–∞—Ç—É —Å –Ω–æ–º–µ—Ä–æ–º $a_i$. –ï—Å–ª–∏ $a_i = -1$ (—Ç—É–ø–∏–∫–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞) –∏–ª–∏ $a_i$ —É–∂–µ –ø–æ—Å–µ—â–∞–ª–∞—Å—å, —Ç–æ –¥–∞–ª—å—à–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–µ–ª—å–∑—è.

–ß—Ç–æ–±—ã –ø–µ—Ä–µ–∫—Ä—ã—Ç—å –ø—É—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–≤–æ—Ä—Ü—É, –Ω—É–∂–Ω–æ –≤—ã—è—Å–Ω–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $i$, —Å–∫–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –ø–æ–¥–∑–µ–º–µ–ª—å–µ, –æ–∫–∞–Ω—á–∏–≤–∞—é—â–∏—Ö—Å—è –≤ $i$-–æ–π –∫–æ–º–Ω–∞—Ç–µ, –µ—Å–ª–∏ –Ω–∞—á–∞—Ç—å –º–æ–∂–Ω–æ –∏–∑ –ª—é–±–æ–π –∫–æ–º–Ω–∞—Ç—ã. –°–ø–æ—Å–æ–±—ã –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—á–∏—Ç–∞—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏, –µ—Å–ª–∏ –æ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã –∏–ª–∏ –µ—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –∫–æ–º–Ω–∞—Ç –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è.

## –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞

–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö $T$ ($1 \le T \le 3 \cdot 10^4$). –î–∞–ª–µ–µ —Å–ª–µ–¥—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ $n$ ($1 \le n \le 2 \cdot 10^5$).
–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç $n$ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ $a_i$ ($a_i = -1$ –∏–ª–∏ $1 \le a_i \le n, a_i \neq i$).

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Å—É–º–º–∞ $n$ –ø–æ –≤—Å–µ–º –Ω–∞–±–æ—Ä–∞–º –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $2 \cdot 10^5$.

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤—ã–≤–µ–¥–∏—Ç–µ $n$ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, –≥–¥–µ $i$-–µ —á–∏—Å–ª–æ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è, –æ–∫–∞–Ω—á–∏–≤–∞—é—â–∏—Ö—Å—è $i$-–æ–π –∫–æ–º–Ω–∞—Ç–æ–π.

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–í –ø–µ—Ä–≤–æ–º –Ω–∞–±–æ—Ä–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è $i = 1$ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –Ω–∞—á–∞—Ç—å —Å 1-–æ–π –∫–æ–º–Ω–∞—Ç—ã.

–í–æ –≤—Ç–æ—Ä–æ–º –Ω–∞–±–æ—Ä–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –¥–æ–π—Ç–∏ –¥–æ –ø–µ—Ä–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã: 1, 2 -> 1; –∏ –¥–ª—è –≤—Ç–æ—Ä–æ–π –∫–æ–º–Ω–∞—Ç—ã: 2, 1 -> 2.

–í —Ç—Ä–µ—Ç—å–µ–º –Ω–∞–±–æ—Ä–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –¥–æ–π—Ç–∏ –¥–æ 2-–æ–π –∫–æ–º–Ω–∞—Ç—ã:
* 1 -> 2, 3 -> 2, 2;
* –∏ –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –ø–µ—Ä–≤–æ–π –∏ —Ç—Ä–µ—Ç—å–µ–π –∫–æ–º–Ω–∞—Ç (1 –∏ 3 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ).

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ | 2 —Å
---|---
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ | 256 –ú–ë

## –ü—Ä–∏–º–µ—Ä 1

### –í–≤–æ–¥
```

6
1
\-1
2
1
\-1
3
2 1
\-1 2
4
2 4 2 -1
5
3 5 -1 2 4
7
3 -1 1 -1 4 5 -1

```

### –í—ã–≤–æ–¥
```

1
2 2
1 3 1
1 3 1 4
1 3 2 3 3
2 1 2 3 2 1 1

```