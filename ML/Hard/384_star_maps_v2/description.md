# Звёздные карты 2.0

Problem ID: star-maps-v2

URL: https://coderun.yandex.ru/problem/star-maps-v2/

Давным давно, в далёкой-далёкой галактике...

Верховный канцлер Палпатин провозгласил себя Императором Галактики и реорганизовал Галактическую Республику в «первую Галактическую Империю». Начав с захвата Сената, утвердив свою власть и положение и выстроив новую вертикаль власти, Палпатин под предлогом мнимого мятежа джедаев издал Декларацию Нового порядка.

Почти что все граждане новообразованной Империи с воодушевлением поддержали идеи, изложенные в Декларации Нового порядка, во многом из-за насилия, охватившего Галактику в последние годы. Многие сенаторы всем сердцем поддержали новое государство, и лишь небольшое число осторожных сенаторов предпочли ждать и наблюдать, как новое правительство будет решать государственные задачи. А оно обещало заменить нестабильность — силой, хаос — порядком и неопределённость — решительностью.

Однако после мнимого благополучия первых лет становления Империи, наступили Тёмные Времена. Император укреплял свою власть, начав чистки против своих противников, в первую очередь против офицеров Старой Республики, которых он не смог соблазнить перейти на его сторону. После Горманской Резни - инцидента с жёстким подавлением мирных протестующих на Гормане, секторе Серн, был создан Альянс за восстановление Республики.

И вот, спустя несколько лет, в Галактике бушует гражданская война. Немногие выжившие джедаи скрываются за границами Империи или заключены под стражу, а строительство Звезды Смерти даёт понять, что Империя готова на любые средства ради поддержания власти над галактикой, не заботясь о собственных гражданах.

Как известно, Хан Соло всегда стреляет первым, а мудрый житель Корусанта Имперского Сектора всегда знает, когда наступает время переехать в более отдалённые уголки Галактики. Но прежде чем садиться на ближайший корабль и совершать гиперпрыжок, следует свериться со звёздными картами. Астро-дроиды вновь приходят на помощь, и тайно посылают вам множество фотографий городов, планет и систем, подконтрольных Альянсу.

К счастью, со времён Старой Республики астро-дроиды научились передавать данные без потерь, но к сожалению, пока что не научились делать это в правильном порядке. Все изображения смешались между собой, и теперь невозможно определить, как они были сгруппированы изначально.

Ваша задача - быстро и эффективно сгруппировать похожие изображения. Достоверно известно, что дроиды передали 983 кластера, каждый из которых содержит от 7 до 10 изображений. Большая часть кластеров - случайные классы, добавленные в набор для маскировки.


## Формат ввода

По ссылке вам доступен набор из 9605 изображений. Каждое изображение однозначно определяется своим именем и относится строго к одному кластеру.


## Формат вывода

Вам нужно распределить изображения по 983 классам.

В Галактической Империи часто используют numpy и pandas, а следовательно и ваш ответ должен быть в формате .csv.

Каждому изображению требуется назначить строго одну метку от 0 до 982. Порядок назначения меток неважен: однако каждому изображению из общего кластера назначается одна и та же метка этого кластера.

Пример submission.csv:

```
filename,label
0001.png,278
0002.png,237
0003.png,11
...
9999.png,458
```


## Примечание

Данные считаются успешно кластеризованными, если значение метрики adjusted mutual information между вашей разметкой и разметкой астро-дроидов достигает хотя бы 0.5.

